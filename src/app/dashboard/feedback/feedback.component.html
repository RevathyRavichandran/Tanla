<div style="background-color: white">
  <form class="example-form" [formGroup]="fg" (ngSubmit)="apply()">
    <div class="row" style="align-items: center">
      <div class="col-2" style="padding-left: 1.5rem;">
        <h1 style="padding-left: 2%; padding-top: 1%; font-weight: bold;">Feedback Report</h1>
      </div>
      <div class="col-2">
        <div class="input-group">
          <input type="search"
            class="form-control"
            id="surveyType"
            (keyup)="showSurveyType($event)"
            aria-label="Search"
            [matAutocomplete]="auto88"
            formControlName="surveyType"
            style="font-family: FontAwesome, Arial; font-style: normal; border-radius: 20px !important"
            placeholder="&#xF002; Search by Survey Type"
          />
          <mat-autocomplete
            #auto88="matAutocomplete"

          >
            <mat-option
              *ngFor="let search of filterSurType"
              [value]="search"
            >
              <span>{{ search }}</span>
            </mat-option>
          </mat-autocomplete>
        </div>
      </div>
      <div class="col-2">
        <div class="input-group">
          <input type="search"
            class="form-control"
            id="survey"
            (keyup)="showSurvey($event)"
            aria-label="Search"
            [matAutocomplete]="auto"
            formControlName="survey"
            style="font-family: FontAwesome, Arial; font-style: normal; border-radius: 20px !important"
            placeholder="&#xF002; Search by Survey Title"
          />
          <mat-autocomplete
            #auto="matAutocomplete"
          >
            <mat-option
              *ngFor="let search of filterSur"
              [value]="search"
            >
              <span>{{ search }}</span>
            </mat-option>
          </mat-autocomplete>
        </div>
      </div>
      <div class="col-3">
        <div class="input-group">
          <input type="search"
          style="font-family: FontAwesome, Arial; font-style: normal; border-radius: 20px !important"
            class="form-control"
            id="category"
            (keyup)="showCategory($event)"
            aria-label="Search"
            placeholder="&#xF002; Search by Service"
            formControlName="category"
            [matAutocomplete]="auto9"
          />
          <mat-autocomplete #auto9="matAutocomplete" (optionSelected)="onCategoryChanged($event)">
            <mat-option
              *ngFor="let search of filterSer"
              [value]="search"
            >
              <span>{{ search }}</span>
            </mat-option>
          </mat-autocomplete>
        </div>
      </div>
      <div class="col-2 pt-3" style="text-align: end">
        <mat-form-field appearance="outline" class="example-form-field">
          <mat-label>Enter a date range</mat-label>
          <mat-date-range-input [rangePicker]="rangePicker">
            <input
              matStartDate
              placeholder="Start date"
              name="startDate"
              formControlName="startDate"
            />
            <input
              matEndDate
              placeholder="End date"
              name="endDate"
              formControlName="endDate"
            />
          </mat-date-range-input>
          <mat-datepicker-toggle
            matSuffix
            [for]="rangePicker"
          ></mat-datepicker-toggle>
          <mat-date-range-picker #rangePicker>
            <mat-date-range-picker-actions>
              <button mat-button matDateRangePickerCancel type="button">
                Cancel
              </button>
              <button
                mat-raised-button
                color="primary"
                matDateRangePickerApply
                type="button"
              >
                Apply
              </button>
            </mat-date-range-picker-actions>
          </mat-date-range-picker>
        </mat-form-field>
      </div>
    </div>
    <div class="row">
      <div class="col-6" style="text-align: end; color: #de1f26">
      Advance filter
      <img [src]="img" alt="" (click)="toggle()" style="cursor: pointer" />
    </div>
      <div class="col-6" style="text-align: end;">
        <span>
        <button type="submit" style="font-weight: 500;" class="btn btn-primary apply-btn">Apply</button>
        <button
          type="button"
          class="btn"
          (click)="clear()"
          style="
            background: #004cf1;
            color: white;
            margin-right: 5px;
            width: 5rem;
          "
        >
          Clear
        </button>
      </span>
      <span matTooltip="Download" matTooltipPosition="above">
        <button mat-button>
          <mat-icon
            style="transform: scale(1.3); color: blue; cursor: pointer"
            (click)="downloadTemplate()"
            >file_download</mat-icon
          >
        </button>
      </span>

    </div>
    </div>

    <div *ngIf="advFilter">
      <div class="row">
        <label class="col-4" style="font-size: 20px; padding-left: 18px"
          >Advanced Filters</label
        >
        <!-- <div class="col-7 mr-3" style="text-align: end; font-size: 15px; color: #de1f26;"><img src="assets/tanla_advanced_filter_clear.svg" alt="">Clear All</div> -->
      </div>
      <div class="row p-3">

        <div class="col-3 form-group mb-2">
          <label for="company"
            ><h2 style="font-size: 1rem; margin: 0 0 8px">
              Company Name:
            </h2></label
          >
          <input type="search"
            style="padding: 0.7rem"
            class="form-control"
            ng-model-options="{debounce: 750}"
            (keyup)="showCompany($event)"
            id="company"
            placeholder="Company Name"
            formControlName="company"
            [matAutocomplete]="auto2"
          />
          <mat-autocomplete
            #auto2="matAutocomplete"
            (optionSelected)="onCompanyChanged($event)"
          >
            <mat-option
              *ngFor="let search of filterCom"
              [value]="search"
            >
              <span>{{ search }}</span>
            </mat-option>
          </mat-autocomplete>
        </div>
        <div class="col-2 form-group">
          <label for="score"
            ><h2 style="font-size: 1rem; margin: 0 0 8px">NPS score:</h2></label
          >
          <input type="search"
          style="padding: 0.7rem"
          class="form-control"
            id="score"
            placeholder="Score"
            formControlName="score"
            [matAutocomplete]="auto7"
          />
          <mat-autocomplete #auto7="matAutocomplete" (optionSelected)='getScore($event.option.value)'>
            <mat-option
              *ngFor="let search of filteredScoreSearch | async"
              [value]="search.value"
            >
              <span>{{ search.label }}</span>
            </mat-option>
          </mat-autocomplete>
          <button type="button" mat-button *ngIf="value" matSuffix mat-icon-button aria-label="Clear" (click)="value = ''">
            <mat-icon>close</mat-icon>
          </button>
        </div>
        <div class="col-1 form-group" *ngIf="promotor">
          <label for="promotors"
            ><h2 style="font-size: 1rem; margin: 0 0 8px">Rating:</h2></label
          >
          <mat-form-field style="width: 90%;" appearance="outline">
            <mat-label>Rating</mat-label>
            <mat-select placeholder="Rating" [formControl]="categoryList" disableOptionCentering multiple>
              <mat-option [value]="11" (click)="selectAll(ev)" #ev>SelectAll</mat-option>
              <mat-option *ngFor="let survey of filteredPromotorsSearch | async" [value]="survey.value">{{survey.label}}</mat-option>
            </mat-select>
          </mat-form-field>
        </div>
        <br />
        <div class="col-1 form-group" *ngIf="passive">
          <label for="promotors"
            ><h2 style="font-size: 1rem; margin: 0 0 8px">Rating:</h2></label
          >
          <mat-form-field style="width: 90%;" appearance="outline">
            <mat-label>Rating</mat-label>
            <mat-select placeholder="Rating" [formControl]="categoryList" disableOptionCentering multiple>
              <mat-option [value]="11" (click)="selectAll(ev)" #ev>SelectAll</mat-option>
              <mat-option *ngFor="let search of filteredPassivesSearch | async" [value]="search.value">{{search.label}}</mat-option>
            </mat-select>
          </mat-form-field>
        </div>
        <div class="col-1 form-group" *ngIf="detractor">
          <label for="promotors"
            ><h2 style="font-size: 1rem; margin: 0 0 8px">Rating:</h2></label
          >
          <mat-form-field style="width: 90%;" appearance="outline">
            <mat-label>Rating</mat-label>
            <mat-select placeholder="Rating" [formControl]="categoryList" disableOptionCentering multiple>
              <mat-option [value]="11" (click)="selectAll(ev)" #ev>SelectAll</mat-option>
              <mat-option *ngFor="let search of filteredDetractorsSearch | async" [value]="search.value">{{search.label}}</mat-option>
            </mat-select>
          </mat-form-field>
        </div>
        <br />
        <div class="col-3 form-group">
          <label for="question"
            ><h2 style="font-size: 1rem; margin: 0 0 8px">Question:</h2></label
          >
          <input type="search"
            style="padding: 0.7rem"
            class="form-control"
            (keyup)="showQuestion($event)"
            id="question"
            placeholder="Question"
            formControlName="question"
            [matAutocomplete]="auto3"
          />
          <mat-autocomplete
            #auto3="matAutocomplete"
            (optionSelected)="onQuestionChanged($event)"
          >
            <mat-option
              *ngFor="let search of filterQue"
              [value]="search"
            >
              <span>{{ search }}</span>
            </mat-option>
          </mat-autocomplete>
        </div>
        <br />

        <div class="col-3 form-group">
          <label for="score"
            ><h2 style="font-size: 1rem; margin: 0 0 8px">Response:</h2></label
          >
          <input type="search"
            style="padding: 0.7rem"
            class="form-control"
            id="answer"
            (keyup)="showAnswer($event)"
            placeholder="Response"
            formControlName="answer"
            [matAutocomplete]="auto21"
          />
          <mat-autocomplete
            #auto21="matAutocomplete"
            (optionSelected)="onAnswerChanged($event)"
          >
            <mat-option
              *ngFor="let search of filterAns"
              [value]="search"
            >
              <span>{{ search }}</span>
            </mat-option>
          </mat-autocomplete>
        </div>
        <!-- <div class="col-3 form-group">
          <label for="name"
            ><h2 style="font-size: 1rem; margin: 0 0 8px">Name:</h2></label
          >
          <input
            style="border-radius: 20px !important"
            class="form-control"
            id="name"
            placeholder="Name"
            formControlName="name"
            [matAutocomplete]="auto8"
          />
          <mat-autocomplete
            #auto8="matAutocomplete"
            (optionSelected)="onNameChanged($event)"
          >
            <mat-option
              *ngFor="let search of filteredNameSearch | async"
              [value]="search.value"
            >
              <span>{{ search.label }}</span>
            </mat-option>
          </mat-autocomplete>
        </div> -->
        <br />
    </div>
    </div>
  </form>
  <!-- <mat-chip-list>
    <mat-chip *ngFor="let val of values" (removed)="remove(val)">
      {{ val }}
      <mat-icon matChipRemove>cancel</mat-icon>
    </mat-chip>
  </mat-chip-list>
  <br *ngIf="values.length > 0" /> -->
  <mat-divider></mat-divider>
</div>
<div *ngIf="isLoad" class="loader-top">
  <mat-spinner class="loader" diameter="50"></mat-spinner>
  <span class="loader-text">Loading... Please wait</span>
</div>
<div class="row" style="padding: 1%">
  <div class="col-lg-12" *ngIf="noRecords">
    <mat-card>
      <div style="text-align: center">
        <img
          style="height: 300px; width: 300px"
          src="assets/no_files_records_256.png"
          alt=""
        />
      </div>
      <div style="text-align: center">
        <h1 style="color: #2d69eb">No Records Found</h1>
      </div>
    </mat-card>
  </div>
  <div class="col-lg-12" *ngIf="!noRecords">
    <div class="row" style="padding: 1%">
      <div class="col-lg-12">
        <table mat-table [dataSource]="dataSource" class="mat-elevation-z8">
          <ng-container matColumnDef="id">
            <th class="sno" mat-header-cell *matHeaderCellDef>S/N</th>
            <td mat-cell *matCellDef="let element">{{ element.id }}</td>
          </ng-container>
          <ng-container matColumnDef="surveyType">
            <th mat-header-cell *matHeaderCellDef>Survey Type</th>
            <td mat-cell *matCellDef="let element">{{ element.surveyType }}</td>
          </ng-container>
          <ng-container matColumnDef="survey_name">
            <th mat-header-cell *matHeaderCellDef>Survey Title</th>
            <td mat-cell *matCellDef="let element">{{ element.survey_name }}</td>
          </ng-container>
          <ng-container matColumnDef="feedback_question_type">
            <th mat-header-cell *matHeaderCellDef>Service</th>
            <td mat-cell *matCellDef="let element">
                {{ element.feedback_question_type }}
            </td>
        </ng-container>
          <ng-container matColumnDef="feedback_question">
            <th mat-header-cell *matHeaderCellDef>Question</th>
            <td mat-cell *matCellDef="let element" class="col-lg-3">
              {{ element.feedback_question }}
            </td>
          </ng-container>
          <ng-container matColumnDef="feedback_answer">
            <th mat-header-cell *matHeaderCellDef>Response</th>
            <td mat-cell *matCellDef="let element" class="col-lg-1">
              {{ element.feedback_answer }}
            </td>
          </ng-container>
          <ng-container matColumnDef="score">
            <th mat-header-cell *matHeaderCellDef>Rating</th>
            <td mat-cell *matCellDef="let element">
              {{ element.score }}
            </td>
          </ng-container>
          <ng-container matColumnDef="employee_name">
            <th mat-header-cell *matHeaderCellDef>Name</th>
            <td mat-cell *matCellDef="let element" class="col-lg-1">
              {{ element.employee_name }}
            </td>
          </ng-container>
          <ng-container matColumnDef="employee_phone_number">
            <th mat-header-cell *matHeaderCellDef>Mobile No</th>
            <td mat-cell *matCellDef="let element">
              {{ element.employee_phone_number }}
            </td>
          </ng-container>
          <ng-container matColumnDef="employee_company">
            <th mat-header-cell *matHeaderCellDef>Company</th>
            <td mat-cell *matCellDef="let element" class="col-lg-1">
              {{ element.employee_company }}
            </td>
          </ng-container>
          <ng-container matColumnDef="created_at">
            <th mat-header-cell *matHeaderCellDef>Date</th>
            <td mat-cell *matCellDef="let element" style="width: 8rem">
              {{ element.created_at }}
            </td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
        </table>
      </div>
    </div>

    <ngb-pagination
      [collectionSize]="totalPages"
      [(page)]="currentPage"
      [maxSize]="2"
      [boundaryLinks]="true"
      [pageSize]="pageSize"
      (pageChange)="pageChanged(currentPage)"
      class="d-flex justify-content-center"
    ></ngb-pagination>
  </div>
</div>
